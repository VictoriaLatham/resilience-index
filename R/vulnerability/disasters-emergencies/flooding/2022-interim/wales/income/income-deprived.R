library(tidyverse)
library(readODS)

source("R/utils.R")

file <-
  download_file(
    "https://gov.wales/sites/default/files/statistics-and-research/2022-02/wimd-2019-index-and-domain-scores-by-small-area.ods",
    ".ods"
  )

raw <-
  read_ods(
    file,
    sheet = "Data",
    skip = 3
  ) |>
  as_tibble()

income_deprived <-
  raw |>
  select(
    lsoa_code = `LSOA code`,
    income_wimd_score = Income
  )

# Save
income_deprived %>%
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-prepare/income-deprived-lsoa.rds")

income_deprived %>%
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-respond/income-deprived-lsoa.rds")

income_deprived %>%
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-recover/income-deprived-lsoa.rds")