library(tidyverse)
library(readxl)
library(geographr)

caci_demographics <-
  read_excel(
    "data/on-disk/caci/demographics.xlsx",
    skip = 10
  )

long_term_unemployed <-
  caci_demographics |>
  filter(str_detect(LSOA, "^W")) |>
  select(lsoa_code = LSOA, long_term_unemployed = `Long-Term Unemployed`, num_working_age = `Persons 16-74...20`) |>
  mutate(
    proportion_long_term_unemployed = long_term_unemployed / num_working_age
  ) |>
  select(lsoa_code, proportion_long_term_unemployed)

# Save
long_term_unemployed |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-prepare/long-term-unemployed-lsoa.rds")

long_term_unemployed |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-respond/long-term-unemployed-lsoa.rds")

long_term_unemployed |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/wales/ability-to-recover/long-term-unemployed-lsoa.rds")