# Load packages
library(dplyr)
library(readxl)
library(stringr)

# CACI data not open source
caci_demographics <- 
  read_excel(
    "data/on-disk/CACI/BRCS_LSOA_Up to Date Demographics_July_2021.xlsx",
    skip = 10
  )

lone_parents_dependent_children <- 
  caci_demographics |> 
  filter(str_detect(LSOA, "^S")) |>
  select(dz_code = LSOA, lone_parents_dependent_children = `Lone Parents With Dependent Children`, households = `Total Households...39`) %>% 
  mutate(
    proportion_lone_parents_dependent_children = lone_parents_dependent_children / households
  ) %>% 
  select(dz_code, proportion_lone_parents_dependent_children)

# Save
lone_parents_dependent_children |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/scotland/community-support/proportion-lone-parents-dependent-children-dz.rds")
