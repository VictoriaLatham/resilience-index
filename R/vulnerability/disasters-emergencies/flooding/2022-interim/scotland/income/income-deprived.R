# Load packages
library(readxl)

source("R/utils.R") # for download_file()

# Source: https://www.gov.scot/publications/scottish-index-of-multiple-deprivation-2020v2-indicator-data/
tf <- download_file(
  "https://www.gov.scot/binaries/content/documents/govscot/publications/statistics/2020/01/scottish-index-of-multiple-deprivation-2020-indicator-data/documents/simd_2020_indicators/simd_2020_indicators/govscot%3Adocument/SIMD%2B2020v2%2B-%2Bindicators.xlsx",
  ".xlsx"
)

raw <- read_excel(tf, sheet = "Data")

# Income_rate = Percentage of people who are income deprived
income_deprived <-
  raw |>
  select(dz_code = Data_Zone, income_deprived = Income_rate)

# Save
income_deprived |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/scotland/ability-to-prepare/income-deprived-dz.rds")

income_deprived |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/scotland/ability-to-respond/income-deprived-dz.rds")

income_deprived |>
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/scotland/ability-to-recover/income-deprived-dz.rds")
