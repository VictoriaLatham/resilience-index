library(dplyr)
library(readxl)

source("R/utils.R")  # for download_file()

# Fetch underlying indicators of deprivation from https://www.nisra.gov.uk/publications/nimdm17-soa-level-results
tf_indicators <- 
  download_file("https://www.nisra.gov.uk/sites/nisra.gov.uk/files/publications/NIMDM17_SOAresults.xls", ".xls")

raw <-
  read_excel(
    tf_indicators,
    sheet = "Employment"
  )

# Population income deprived
unemployment <- 
  raw %>%  
  select(soa_code = SOA2001, proportion_unemployed = `Proportion of the working age population who are employment deprived
(%)`)

# Save
unemployment %>% 
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/northern-ireland/ability-to-prepare/proportion_unemployed-lsoa.rds")

unemployment %>% 
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/northern-ireland/ability-to-respond/proportion_unemployed-lsoa.rds")

unemployment %>% 
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/northern-ireland/ability-to-recover/proportion_unemployed-lsoa.rds")
