library(readr)
library(tidyr)
library(dplyr)
library(stringr)
library(geographr)
source("R/utils.R")

# Calculate older population (aged 65+) proportions for SOAs
older_soa <- 
  population_soa %>% 
  filter(sex == "All") %>% 
  rename(
    num_people_over_65 = `65+`,
    num_people = total_population
  ) %>% 
  
  mutate(proportion_over_65 = num_people_over_65 / num_people) %>% 
  
  select(soa_code, num_people, num_people_over_65, proportion_over_65)

# Save
older_soa %>%
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/northern-ireland/susceptibility/older-population-lsoa.rds")
