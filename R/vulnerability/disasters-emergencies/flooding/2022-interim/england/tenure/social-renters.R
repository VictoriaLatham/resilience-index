library(readr)
library(tidyr)
library(dplyr)
library(readxl)
library(stringr)
library(geographr)

caci_demographics <- 
  read_excel(
    "C:/Users/040026704/British Red Cross Society/Strategic Insight and Foresight - Documents/Data/CACI/BRCS_LSOA_Up to Date Demographics_July_2021.xlsx",
    skip = 10
  )

social_renters <- 
  caci_demographics %>% 
  filter(str_detect(LSOA, "^E")) %>% 
  select(
    lsoa_code = LSOA, 
    social_renting_la = `Social Renting: From Local Authority`,
    social_renting_other = `Social Renting: From Housing Association Or Other Provider`, 
    num_households = `Total Households...39`
  ) %>% 
  mutate(
    social_renters = social_renting_la + social_renting_other,
    proportion_social_renters = social_renters / num_households
  ) %>% 
  select(lsoa_code, proportion_social_renters)

# Save
social_renters %>%
  write_rds("data/vulnerability/disasters-emergencies/flooding/2022-interim/england/ability-to-prepare/social-renters-lsoa.rds")

